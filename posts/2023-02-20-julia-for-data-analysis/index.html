<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tomás Aragón">
<meta name="dcterms.date" content="2023-02-20">
<meta name="description" content="“A book review for population health data scientists”">

<title>Dr.&nbsp;Tomás Aragón - Julia for Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-111617948-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Dr.&nbsp;Tomás Aragón - Julia for Data Analysis">
<meta name="twitter:description" content="“A book review for population health data scientists”">
<meta name="twitter:image" content="https://drtomasaragon.github.io/posts/2023-02-20-julia-for-data-analysis/images/book_cover_julia_for_data_analysis_1400x865.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Dr.&nbsp;Tomás Aragón</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../works.html" rel="" target="">
 <span class="menu-text">Works</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../subscription.html" rel="" target="">
 <span class="menu-text">Subscribe</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://threads.net/drtomasaragon" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/drtomasaragon" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/drtomasaragon" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Julia for Data Analysis</h1>
                  <div>
        <div class="description">
          <p>“A book review for population health data scientists”</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Book review</div>
                <div class="quarto-category">Julia</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Data science</div>
                <div class="quarto-category">Programming</div>
                <div class="quarto-category">Epidemiology</div>
                <div class="quarto-category">Scientific computing</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://taragonmd.github.io">Tomás Aragón</a> <a href="https://orcid.org/0000-0002-2058-0423" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              California Department of Public Health
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 20, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#book-highlights" id="toc-book-highlights" class="nav-link" data-scroll-target="#book-highlights"><span class="header-section-number">2</span> Book highlights</a>
  <ul class="collapse">
  <li><a href="#chapter-1-introduction" id="toc-chapter-1-introduction" class="nav-link" data-scroll-target="#chapter-1-introduction"><span class="header-section-number">2.1</span> Chapter 1 Introduction</a></li>
  <li><a href="#getting-started-with-julia" id="toc-getting-started-with-julia" class="nav-link" data-scroll-target="#getting-started-with-julia"><span class="header-section-number">2.2</span> 2 Getting started with Julia</a></li>
  <li><a href="#chapters-813-working-with-data-frames" id="toc-chapters-813-working-with-data-frames" class="nav-link" data-scroll-target="#chapters-813-working-with-data-frames"><span class="header-section-number">2.3</span> Chapters 8–13: Working with data frames</a></li>
  <li><a href="#the-split-apply-combine-workflow" id="toc-the-split-apply-combine-workflow" class="nav-link" data-scroll-target="#the-split-apply-combine-workflow"><span class="header-section-number">2.4</span> The split-apply-combine workflow</a></li>
  </ul></li>
  <li><a href="#appendix-data-dictionary-for-nhefs-data-file" id="toc-appendix-data-dictionary-for-nhefs-data-file" class="nav-link" data-scroll-target="#appendix-data-dictionary-for-nhefs-data-file"><span class="header-section-number">3</span> Appendix: Data dictionary for NHEFS data file</a></li>
  <li><a href="#updates-from-book-author" id="toc-updates-from-book-author" class="nav-link" data-scroll-target="#updates-from-book-author"><span class="header-section-number">4</span> Updates from book author</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<p>Julia is an open source, general purpose programming language for scientific computing and is well suited for data science. I taught R programming for several years at the UC Berkeley School of Public Health. I recently posted a blog entry on why I switched from R to Julia (“<a href="../2023-01-14-my-journey-from-r-to-julia/index.html">My Journey from R to Julia</a>”). In this blog entry I review the book “<a href="https://www.manning.com/books/julia-for-data-analysis">Julia for Data Analysis</a>” by Bogumit Kaminski <span class="citation" data-cites="Kaminski2023-isbn978-1633439368">[<a href="#ref-Kaminski2023-isbn978-1633439368" role="doc-biblioref">1</a>]</span>. In short, this is an outstanding book that I highly recommend without any reservations (5/5 stars). This review is a working blog that I will be updating with highlights from the book.</p>
<p>For data science, Julia is exploding in popularity and there are numerous outstanding <a href="https://julialang.org/learning/">resources for learning Julia</a>, including books, videos, and blog postings. I purchased the print and eBook option which includes an online “liveBook” which is easy to read. However, we cannot beat having a book in hand to read and markup. The author provides a GitHub <a href="https://github.com/bkamins/JuliaForDataAnalysis">repository</a> with code and data files.</p>
<p>The author, Bogumit Kaminski, is a core developer of the <a href="https://dataframes.juliadata.org/stable/">DataFrames.jl</a> package. He is an associate professor and head of the Decision Support and Analysis Unit at the SGH Warsaw School of Economics, as well as adjunct professor at the data science laboratory, Ryerson University, Toronto.</p>
<p>This book is perfect for population health data scientists already familiar with R or Python, or already have basic proficiency with Julia but need an in depth and systematic introduction to Julia for data science.</p>
<p>Here is the table of contents.</p>
<ol type="1">
<li>Introduction</li>
<li>Getting started with Julia</li>
<li>Julia’s support for scaling projects</li>
<li>Working with collections in Julia</li>
<li>Advanced topics on handling collections</li>
<li>Working with strings</li>
<li>Handling time-series data and missing values</li>
<li>First steps with data frames</li>
<li>Getting data from a data frame</li>
<li>Creating data frame objects</li>
<li>Converting and grouping data frames</li>
<li>Mutating and transforming data frames</li>
<li>Advanced transformations of data frames</li>
<li>Creating web services for sharing data analysis results</li>
</ol>
</section>
<section id="book-highlights" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="book-highlights"><span class="header-section-number">2</span> Book highlights</h2>
<section id="chapter-1-introduction" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="chapter-1-introduction"><span class="header-section-number">2.1</span> Chapter 1 Introduction</h3>
<p>My blog posting “<a href="../2023-01-14-my-journey-from-r-to-julia/index.html">My Journey from R to Julia</a>” is a good summary of what is covered in the Introduction. I will cover just one item—execution speed, and compare it to R.</p>
<p>We will construct a <code>for</code> loop summation of a random sequence of integers from 1 to 1,000,000,000 (1 billion) that are sampled without replacment.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Here is the correct answer as a reference:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">## In Julia</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>julia<span class="op">&gt;</span>  <span class="fu">sum</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">1_000_000_000</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fl">500000000500000000</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">## In R</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="fu">options</span>(digits<span class="op">=</span><span class="fl">20</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="fu">sum</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">1000000000</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1</span>] <span class="fl">5.000000005e+17</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By default, R would give the wrong answer (not shown) because it uses 64-bit floating point numbers.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> To get the correct answer we need 64-bit integers. For this I used the <code>bit64</code> R package to get the correct answer (below).</p>
<!--
require("bit64")
n = 100;
samp = sample(1:n, n, replace=FALSE);
sum_n = function(x){
    s = as.integer64(0)
    for (i in x){
        s = s + i
    }
    s
}
system.time(x <- sum_n(samp))
x
####
options(digits=20)
sum_n = function(n){
    s = 0
    for (i in 1:n){
        s = s + i
    }
    s
}
system.time(x <- sum_n(1000000000))
x
-->
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="fu">require</span>(<span class="st">"bit64"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> n <span class="op">=</span> <span class="fl">1000000000</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> samp <span class="op">=</span> <span class="fu">sample</span>(<span class="fl">1</span><span class="op">:</span>n, n, replace<span class="op">=</span>FALSE)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> sum_n <span class="op">=</span> <span class="kw">function</span>(x){</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>     s <span class="op">=</span> as.<span class="fu">integer64</span>(<span class="fl">0</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>     <span class="cf">for</span> (i <span class="kw">in</span> x){</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>         s <span class="op">=</span> s <span class="op">+</span> i</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>     }</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>     s</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> }</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> system.<span class="fu">time</span>(x <span class="op">&lt;-</span> <span class="fu">sum_n</span>(samp))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>     user    system   elapsed </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fl">11094.792</span>   <span class="fl">101.378</span> <span class="fl">11201.145</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> x</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>integer64</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1</span>] <span class="fl">500000000500000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To get the correct answer in R, the execution time was about <strong>11,095 seconds</strong>. Okay, let’s try Julia.</p>
<!--
using StatsBase, BenchmarkTools
n = 1_000_000_000;
samp = sample(1:n, n, replace=false);
function sum_n(x)
    s = 0
    for i in x
        s = s + i
    end
    return s
end
@btime sum_n(samp)
-->
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>julia<span class="op">&gt;</span> <span class="im">using</span> <span class="bu">StatsBase</span>, <span class="bu">BenchmarkTools</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>julia<span class="op">&gt;</span> n <span class="op">=</span> <span class="fl">1_000_000_000</span>;</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>julia<span class="op">&gt;</span> samp <span class="op">=</span> <span class="fu">sample</span>(<span class="fl">1</span><span class="op">:</span>n, n, replace<span class="op">=</span><span class="cn">false</span>);</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>julia<span class="op">&gt;</span> <span class="kw">function</span> <span class="fu">sum_n</span>(x)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>           s <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> i <span class="kw">in</span> x</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                   s <span class="op">=</span> s <span class="op">+</span> i</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>               <span class="cf">end</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>               <span class="cf">return</span> s</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>       <span class="kw">end</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>sum_n (generic <span class="kw">function</span> with <span class="fl">1</span> method)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>julia<span class="op">&gt;</span> <span class="pp">@btime</span> <span class="fu">sum_n</span>(samp)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fl">158.118</span> ms (<span class="fl">1</span> allocation<span class="op">:</span> <span class="fl">16</span> bytes)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fl">500000000500000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In Julia, it took about <strong>158 milliseconds</strong>. R is about <strong>70,168 times slower</strong> than Julia!<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>Conclusion: Compared to R, Julia can handle large <code>for</code> loops for summation and give an accurate answer fast. To add integers correctly using a <code>for</code> loop, R requires using the <code>bit64</code> package but is 70,168 time slower than Julia. With R, we are taught to avoid <code>for</code> loops — now you know why. However, a <code>for</code> loop is a workhorse tool that we want available to us; hence, this a huge advantage of Julia.</p>
<p>To see more benchmarks visit <a href="https://benchmarksgame-team.pages.debian.net/benchmarksgame/index.html">Which programming language is fastest?</a>.</p>
</section>
<section id="getting-started-with-julia" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="getting-started-with-julia"><span class="header-section-number">2.2</span> 2 Getting started with Julia</h3>
<section id="basic-data-types" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="basic-data-types"><span class="header-section-number">2.2.1</span> Basic data types</h4>
<p>If you are familar with R or Python, you will feel comfortable with Julia. Here is a <strong>character</strong>:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">## character; notice single quotation marks</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ch">'a'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>'a': ASCII/Unicode U+0061 (category Ll: Letter, lowercase)</code></pre>
</div>
</div>
<p>A <strong>string</strong> is a collection of characters:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">## string; notice double quotation marks</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="st">"Hello World"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>"Hello World"</code></pre>
</div>
</div>
<p>An <strong>array</strong> is a collection in brackets. A <strong>vector</strong> is a 1-dimensional array. Commas are used to create a vector. By default, the vector is displayed vertically, but it is not a “column vector”.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## vector</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>3-element Vector{Int64}:
 1
 2
 3</code></pre>
</div>
</div>
<p>To display horizontally use the <code>show</code> function.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">## vector</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>([<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2, 3]</code></pre>
</div>
</div>
<p>A <strong>matrix</strong> is a two-dimensional array. Numbers separated by spaces create one row of a <strong>matrix</strong>. This is not a vector.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">## matrix</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1</span> <span class="fl">2</span> <span class="fl">3</span> <span class="fl">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>1×4 Matrix{Int64}:
 1  2  3  4</code></pre>
</div>
</div>
<p>Matrix rows separated by a semi-colon creates a multi-row matrix:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">## matrix</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1</span> <span class="fl">2</span> <span class="fl">3</span> <span class="fl">4</span>; <span class="fl">6</span> <span class="fl">7</span> <span class="fl">8</span> <span class="fl">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>2×4 Matrix{Int64}:
 1  2  3  4
 6  7  8  9</code></pre>
</div>
</div>
<p>The <code>size</code> function returns the dimensions of an array. Previously, we learned that a vector is a 1-dimensional array.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">size</span>([<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(3,)</code></pre>
</div>
</div>
<p>We see this vector is 1-dimensional (<code>(3,)</code>); in contrast,</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">size</span>([<span class="fl">1</span> <span class="fl">2</span> <span class="fl">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>(1, 3)</code></pre>
</div>
</div>
<p>this is a <code>(1, 3)</code> matrix or 2-dimensional.</p>
<p>A <strong>tuple</strong> is a collection in parentheses, and commas separate the elements. Above, the <code>size</code> function returned a tuple. Tuples are immutable; their elements cannot be changed. Immutable objects increase computational speed.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">## tuple</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>(<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(1, 2, 3)</code></pre>
</div>
</div>
<p>Tuple elements can be named.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">## named tuple</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>(four <span class="op">=</span> <span class="fl">4</span>, five <span class="op">=</span> <span class="fl">5</span>, six <span class="op">=</span> <span class="fl">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>(four = 4, five = 5, six = 6)</code></pre>
</div>
</div>
<p>The assigment operation (<code>=</code>) is used to <strong>bind</strong> data <em>values</em> to a <strong>variable</strong>. Binding in Julia is similar to binding in Python, but not in R.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>2-element Vector{Int64}:
 1
 2</code></pre>
</div>
</div>
<p>If we change an element in <code>x</code>, the same change occurs in <code>y</code> because same array was binded to the variables <code>x</code> and <code>y</code>.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>x[<span class="fl">2</span>] <span class="op">=</span> <span class="fl">99</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">## notice that y changes also</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>2-element Vector{Int64}:
  1
 99</code></pre>
</div>
</div>
<p>This is not the case in R:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> x <span class="op">=</span> <span class="fu">c</span>(<span class="fl">1</span>, <span class="fl">2</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> y <span class="op">=</span> x</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> x[<span class="fl">2</span>] <span class="op">=</span> <span class="fl">99</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> x</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1</span>]  <span class="fl">1</span> <span class="fl">99</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> y</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1</span>] <span class="fl">1</span> <span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To replicate the R experience in Julia we assign a copy of <code>x</code> to <code>y</code>.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fu">copy</span>(x)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>x[<span class="fl">2</span>] <span class="op">=</span> <span class="fl">99</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>2-element Vector{Int64}:
  1
 99</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>2-element Vector{Int64}:
 1
 2</code></pre>
</div>
</div>
</section>
<section id="basic-functions" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="basic-functions"><span class="header-section-number">2.2.2</span> Basic functions</h4>
<p>In my blog posting “<a href="../2023-01-14-my-journey-from-r-to-julia/index.html">My Journey from R to Julia</a>” I demonstrated how to create a simple function to calculate the odds ratio using 3 methods with multiple dispatch.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> I will use the function that calculates the odds ratio using the cross-product of 4 integers, and build a more useful function to illustrate some features of Julia.</p>
<p>For an appropriately structured table, for example,</p>
<table class="table">
<thead>
<tr class="header">
<th>Exposure</th>
<th style="text-align: center;">Disease</th>
<th style="text-align: center;">No disease</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Yes</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td>No</td>
<td style="text-align: center;">c</td>
<td style="text-align: center;">d</td>
</tr>
</tbody>
</table>
<p>the odds ratio is the cross-product:</p>
<p><span class="math display">\[
OR = \frac{a d}{b c}
\]</span></p>
<p>Here is a simple Julia function to calculate the odds ratio:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">oddsratio</span>(a, b, c, d)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    or <span class="op">=</span> (a <span class="op">*</span> d) <span class="op">/</span> (b <span class="op">*</span> c)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> or</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>oddsratio (generic function with 1 method)</code></pre>
</div>
</div>
<p>Because this is a simple function, it can also be created in an abbreviated form:</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oddsratio</span>(a, b, c, d) <span class="op">=</span> (a <span class="op">*</span> d) <span class="op">/</span> (b <span class="op">*</span> c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>oddsratio (generic function with 1 method)</code></pre>
</div>
</div>
<p>Here is data from a case-control study <span class="citation" data-cites="Aragon2003_pmid12515584">[<a href="#ref-Aragon2003_pmid12515584" role="doc-biblioref">2</a>]</span>:</p>
<table class="table">
<thead>
<tr class="header">
<th>Exposure</th>
<th style="text-align: right;">Case</th>
<th style="text-align: right;">Control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Highest</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td>Lowest</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">29</td>
</tr>
</tbody>
</table>
<p>Let’s test the <code>oddsratio</code> function by passing four integers from our 2x2 table.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oddsratio</span>(<span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>29.0</code></pre>
</div>
</div>
<p>The function <em>arguments</em>, <code>a</code>, <code>b</code>, <code>c</code>, and <code>d</code> are called <strong>positional</strong> arguments and are always required in the correct order.</p>
<p>We now add a <strong>keyword</strong> argument which is optional. Keyword arguments are separated from the positional arguments by a semicolon (;). Any argument, positional or keyword, can be assigned a default value. We’ll create <code>oddsratio2</code>function to calculate a confidence interval using the Normal approximation. The keyword argument will have a default confidence level of 0.95.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions </span><span class="co"># to access standard normal distribution </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">oddsratio2</span>(a, b, c, d; level <span class="op">=</span> <span class="fl">0.95</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    zv <span class="op">=</span> <span class="fu">quantile</span>(<span class="fu">Normal</span>(), <span class="fl">0.5</span><span class="fu">*</span>(<span class="fl">1</span> <span class="op">+</span> level))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    est <span class="op">=</span> (a <span class="op">*</span> d) <span class="op">/</span> (b <span class="op">*</span> c)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    log_or <span class="op">=</span> <span class="fu">log</span>(est)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    se_log_or <span class="op">=</span> <span class="fu">sqrt</span>((<span class="fl">1</span><span class="op">/</span>a) <span class="op">+</span> (<span class="fl">1</span><span class="op">/</span>b) <span class="op">+</span> (<span class="fl">1</span><span class="op">/</span>c) <span class="op">+</span> (<span class="fl">1</span><span class="op">/</span>d))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    lcl <span class="op">=</span> <span class="fu">exp</span>(log_or <span class="op">-</span> zv <span class="op">*</span> se_log_or)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    ucl <span class="op">=</span> <span class="fu">exp</span>(log_or <span class="op">+</span> zv <span class="op">*</span> se_log_or)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>        or <span class="op">=</span> est, </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>        confint <span class="op">=</span> (lcl, ucl), </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>        level <span class="op">=</span> level</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>oddsratio2 (generic function with 1 method)</code></pre>
</div>
</div>
<p>By default, <code>oddsratio2</code> will calculate the 95% confidence interval:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oddsratio2</span>(<span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(or = 29.0, confint = (5.110695577009899, 164.55685675804662), level = 0.95)</code></pre>
</div>
</div>
<p>I can also calculate 99% confidence intervals:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> <span class="fu">oddsratio2</span>(<span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">29</span>; level <span class="op">=</span> <span class="fl">0.99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>(or = 29.0, confint = (2.9619778898301936, 283.93189661797715), level = 0.99)</code></pre>
</div>
</div>
<p>And we can index elements of the named tuple.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>results.confint</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>(2.9619778898301936, 283.93189661797715)</code></pre>
</div>
</div>
</section>
<section id="anonymous-functions" class="level4" data-number="2.2.3">
<h4 data-number="2.2.3" class="anchored" data-anchor-id="anonymous-functions"><span class="header-section-number">2.2.3</span> Anonymous functions</h4>
<p>Functions can be arguments to functions. For example, we will create a <code>times_two</code> function and past it to other functions.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">times_two</span>(x) <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> x</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(times_two, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>3-element Vector{Int64}:
  2
  4
 16</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(times_two, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>22</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsBase</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(times_two, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>7.333333333333333</code></pre>
</div>
</div>
<p>Alternatively, we can pass the <code>times_two</code> function as an anonymous function; that is, a function without a name.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(x <span class="op">-&gt;</span> <span class="fl">2</span> <span class="op">*</span> x, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>3-element Vector{Int64}:
  2
  4
 16</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x <span class="op">-&gt;</span> <span class="fl">2</span> <span class="op">*</span> x, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>22</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x <span class="op">-&gt;</span> <span class="fl">2</span> <span class="op">*</span> x, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>7.333333333333333</code></pre>
</div>
</div>
<p>We can even calculate the odds ratio as an anonymous function.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>((a, b, c, d) <span class="op">-&gt;</span> (a <span class="op">*</span> d)<span class="op">/</span>(b <span class="op">*</span> c), (<span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">29</span>)<span class="op">...</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>29.0</code></pre>
</div>
</div>
<p>Notice I used a trick. By default, the <code>map</code> function maps and executes a function with elements of a collection (eg, <code>[1 ,2, 8]</code>). However, for the odds ratio calcuation, I need to map the arguments <code>(a, b, c, d)</code> to their values <code>(12, 6, 2, 29)</code>, <em>then</em> calculate the odds ratio. Therefore, I used the splat operator (<code>...</code>) to break up the collection of values so that they could be mapped to their arguments first. Although I used a tuple <code>(12, 6, 2, 29)</code>, an array also works <code>[12, 6, 2, 29]</code>.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>((a, b, c, d) <span class="op">-&gt;</span> (a <span class="op">*</span> d)<span class="op">/</span>(b <span class="op">*</span> c), [<span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">29</span>]<span class="op">...</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>29.0</code></pre>
</div>
</div>
<p>The splat operator (<code>...</code>) converts <code>[12, 6, 2, 29]</code> to <code>12, 6, 2, 29</code> which is very convenient if the vector is very large. In this case, with only four integers, I could have passed the integers without the splat operator.</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>((a, b, c, d) <span class="op">-&gt;</span> (a <span class="op">*</span> d)<span class="op">/</span>(b <span class="op">*</span> c), <span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>29.0</code></pre>
</div>
</div>
<p>Chapter 1 also covers other topics including loops, conditional expressions, and scoping. Chapters 3 to 7 cover practical tools for processing and managing data in Julia. I will focus the remainder of this book review on data frames.</p>
</section>
</section>
<section id="chapters-813-working-with-data-frames" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="chapters-813-working-with-data-frames"><span class="header-section-number">2.3</span> Chapters 8–13: Working with data frames</h3>
<p>The author is a lead developer of the <a href="https://dataframes.juliadata.org/stable/"><code>DataFrames.jl</code></a> Julia package. So in these chapters he covers this package thoroughly and you will not be disappointed. I will over cover the following:</p>
<ul>
<li>Downloading a CSV data file from a website</li>
<li>Reading a CSV file into a data frame</li>
<li>Conducting a common analytic workflows</li>
</ul>
<p>The data set we will use is from National Health and Nutrition Examination Survey Data I Epidemiologic Follow-up Study (NHEFS). The version of the NHEFS data set we will use in from Professor Migual Hernan’s textbook “<a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">Causal Inference — What if</a>.”</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="bu">Downloads</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CSV</span>, <span class="bu">DataFrames</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Downloads</span>.<span class="fu">download</span>(<span class="st">"https://www.hsph.harvard.edu/miguel-hernan/wp-content"</span> <span class="op">*</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"/uploads/sites/1268/2019/03/nhefs.csv"</span>, <span class="st">"nhefs.csv"</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">readlines</span>(<span class="st">"nhefs.csv"</span>)[<span class="fl">1</span><span class="op">:</span><span class="fl">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>6-element Vector{String}:
 "seqn,qsmk,death,yrdth,modth,dad" ⋯ 465 bytes ⋯ "ax71,tax82,price71_82,tax71_82"
 "233,0,0,,,,175,96,0,42,1,19,2,7" ⋯ 172 bytes ⋯ "0977,0.4437866211,0.6403808594"
 "235,0,0,,,,123,80,0,36,0,18,2,9" ⋯ 169 bytes ⋯ "994141,0.5493164063,0.79296875"
 "244,0,0,,,,115,75,1,56,1,15,3,1" ⋯ 170 bytes ⋯ "5488,0.0561981201,0.3202514648"
 "245,0,1,85,2,14,148,78,0,68,1,1" ⋯ 174 bytes ⋯ "7031,0.0547943115,0.3049926758"
 "252,0,0,,,,118,77,0,40,0,18,2,1" ⋯ 168 bytes ⋯ "994141,0.5493164063,0.79296875"</code></pre>
</div>
</div>
<p>We are using the <code>Download</code>, <code>CSV</code>, and <code>Dataframes</code> modules.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<p>The data file has a header (variable names). If there is no header see p.&nbsp;191 of book.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>nhefs <span class="op">=</span> CSV.<span class="fu">read</span>(<span class="st">"nhefs.csv"</span>, DataFrame)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>nhefs[<span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div class="data-frame"><p>6 rows × 64 columns (omitted printing of 53 columns)</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">seqn</th>
<th data-quarto-table-cell-role="th">qsmk</th>
<th data-quarto-table-cell-role="th">death</th>
<th data-quarto-table-cell-role="th">yrdth</th>
<th data-quarto-table-cell-role="th">modth</th>
<th data-quarto-table-cell-role="th">dadth</th>
<th data-quarto-table-cell-role="th">sbp</th>
<th data-quarto-table-cell-role="th">dbp</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">race</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>233</td>
<td>0</td>
<td>0</td>
<td><em>missing</em></td>
<td><em>missing</em></td>
<td><em>missing</em></td>
<td>175</td>
<td>96</td>
<td>0</td>
<td>42</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>235</td>
<td>0</td>
<td>0</td>
<td><em>missing</em></td>
<td><em>missing</em></td>
<td><em>missing</em></td>
<td>123</td>
<td>80</td>
<td>0</td>
<td>36</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>244</td>
<td>0</td>
<td>0</td>
<td><em>missing</em></td>
<td><em>missing</em></td>
<td><em>missing</em></td>
<td>115</td>
<td>75</td>
<td>1</td>
<td>56</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>245</td>
<td>0</td>
<td>1</td>
<td>85</td>
<td>2</td>
<td>14</td>
<td>148</td>
<td>78</td>
<td>0</td>
<td>68</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>252</td>
<td>0</td>
<td>0</td>
<td><em>missing</em></td>
<td><em>missing</em></td>
<td><em>missing</em></td>
<td>118</td>
<td>77</td>
<td>0</td>
<td>40</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>257</td>
<td>0</td>
<td>0</td>
<td><em>missing</em></td>
<td><em>missing</em></td>
<td><em>missing</em></td>
<td>141</td>
<td>83</td>
<td>1</td>
<td>43</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To see all the variable names we will take the vector of 64 names and reshape them into a 16 by 4 matrix for display purposes.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>vn <span class="op">=</span> <span class="fu">names</span>(nhefs)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">reshape</span>(vn, <span class="op">:</span>, <span class="fl">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>16×4 Matrix{String}:
 "seqn"       "wt71"               "hayfever"        "hbpmed"
 "qsmk"       "wt82"               "diabetes"        "boweltrouble"
 "death"      "wt82_71"            "polio"           "wtloss"
 "yrdth"      "birthplace"         "tumor"           "infection"
 "modth"      "smokeintensity"     "nervousbreak"    "active"
 "dadth"      "smkintensity82_71"  "alcoholpy"       "exercise"
 "sbp"        "smokeyrs"           "alcoholfreq"     "birthcontrol"
 "dbp"        "asthma"             "alcoholtype"     "pregnancies"
 "sex"        "bronch"             "alcoholhowmuch"  "cholesterol"
 "age"        "tb"                 "pica"            "hightax82"
 "race"       "hf"                 "headache"        "price71"
 "income"     "hbp"                "otherpain"       "price82"
 "marital"    "pepticulcer"        "weakheart"       "tax71"
 "school"     "colitis"            "allergies"       "tax82"
 "education"  "hepatitis"          "nerves"          "price71_82"
 "ht"         "chroniccough"       "lackpep"         "tax71_82"</code></pre>
</div>
</div>
</section>
<section id="the-split-apply-combine-workflow" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="the-split-apply-combine-workflow"><span class="header-section-number">2.4</span> The split-apply-combine workflow</h3>
<p>We will apply a common workflow (<a href="#fig-split">Figure&nbsp;1</a>):</p>
<ol type="1">
<li><strong>split</strong> (stratify) the data by one or more variables</li>
<li><strong>apply</strong> a function to each strata</li>
<li><strong>combine</strong> the results into a table</li>
</ol>
<div id="fig-split" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/phds_split_apply_combine_workflow.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1: The split-apply-combine is a common workflow in data science.</figcaption>
</figure>
</div>
<p>For split-apply-combine we will conduct the following analysis:</p>
<ul>
<li>Stratified by sex and race, what is the proportion of deaths?</li>
<li>Stratified by sex and race, what is the mean age?</li>
</ul>
<p>We start by creating smaller data set with these four variables, and describing them.</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>nhefs4 <span class="op">=</span> nhefs[<span class="op">:</span>,[<span class="op">:</span>death,<span class="op">:</span>sex,<span class="op">:</span>age,<span class="op">:</span>race]]</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(nhefs4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div class="data-frame"><p>4 rows × 7 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">median</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">nmissing</th>
<th data-quarto-table-cell-role="th">eltype</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Symbol">Symbol</th>
<th data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="DataType">DataType</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>death</td>
<td>0.195212</td>
<td>0</td>
<td>0.0</td>
<td>1</td>
<td>0</td>
<td>Int64</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>sex</td>
<td>0.509515</td>
<td>0</td>
<td>1.0</td>
<td>1</td>
<td>0</td>
<td>Int64</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>age</td>
<td>43.9153</td>
<td>25</td>
<td>44.0</td>
<td>74</td>
<td>0</td>
<td>Int64</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>race</td>
<td>0.131983</td>
<td>0</td>
<td>0.0</td>
<td>1</td>
<td>0</td>
<td>Int64</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>For “split” we use the <code>groupby</code> function, and for “apply” and “combine” we use the <code>combine</code> function. I also insert a column with description of strate (eg, “white female”).</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> <span class="fu">groupby</span>(nhefs4, [<span class="op">:</span>sex, <span class="op">:</span>race])</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> <span class="fu">combine</span>(gdf,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>death <span class="op">=&gt;</span> mean,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>age <span class="op">=&gt;</span> mean)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">insertcols!</span>(results, </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>strata <span class="op">=&gt;</span> [<span class="st">"white male"</span>, <span class="st">"black male"</span>, <span class="st">"white female"</span>, <span class="st">"black female"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div class="data-frame"><p>4 rows × 5 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">race</th>
<th data-quarto-table-cell-role="th">death_mean</th>
<th data-quarto-table-cell-role="th">age_mean</th>
<th data-quarto-table-cell-role="th">strata</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>0</td>
<td>0.239716</td>
<td>44.5262</td>
<td>white male</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>1</td>
<td>0.276596</td>
<td>45.0638</td>
<td>black male</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>0</td>
<td>0.141044</td>
<td>43.3808</td>
<td>white female</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>1</td>
<td>0.190083</td>
<td>42.595</td>
<td>black female</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Conclusions:</p>
<ul>
<li>In 1971, the mean age of males was slightly higher than the mean age of females.</li>
<li>By 1992, a higher proportion of males died.</li>
<li>By 1992, within sex strata, a higher proportion of Blacks died compared to whites.</li>
</ul>
</section>
</section>
<section id="appendix-data-dictionary-for-nhefs-data-file" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="appendix-data-dictionary-for-nhefs-data-file"><span class="header-section-number">3</span> Appendix: Data dictionary for NHEFS data file</h2>
<p>Download data dictionary which is an Microsoft Excel XLSX file.</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Downloads</span>.<span class="fu">download</span>(<span class="st">"https://www.hsph.harvard.edu/miguel-hernan/wp-content"</span> <span class="op">*</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"/uploads/sites/1268/2012/10/NHEFS_Codebook.xls"</span>,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"NHEFS_Codebook.xls"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>"NHEFS_Codebook.xls"</code></pre>
</div>
</div>
<p>Then, open up in you MS Excel and manually save as a CSV file. Although the Julia <code>XLSX.jl</code> package can read <code>.xlsx</code> files, it cannot read old <code>.xls</code> file (yet). So this is a work around.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>cb <span class="op">=</span> CSV.<span class="fu">read</span>(<span class="st">"NHEFS_Codebook.csv"</span>, DataFrame)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">insertcols!</span>(cb, <span class="fl">1</span>, <span class="op">:</span>row <span class="op">=&gt;</span> <span class="fl">1</span><span class="op">:</span><span class="fl">64</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>cb[<span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div class="data-frame"><p>20 rows × 3 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">row</th>
<th data-quarto-table-cell-role="th">Variable</th>
<th data-quarto-table-cell-role="th">Description</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="String31">String31</th>
<th data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>active</td>
<td>IN YOUR USUAL DAY, HOW ACTIVE ARE YOU? IN 1971, 0:very active, 1:moderately active, 2:inactive</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>age</td>
<td>AGE IN 1971</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>alcoholfreq</td>
<td>HOW OFTEN DO YOU DRINK? IN 1971 0: Almost every day, 1: 2-3 times/week, 2: 1-4 times/month, 3: &lt; 12 times/year, 4: No alcohol last year, 5: Unknown</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>alcoholhowmuch</td>
<td>WHEN YOU DRINK, HOW MUCH DO YOU DRINK? IN 1971</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>5</td>
<td>alcoholpy</td>
<td>HAVE YOU HAD 1 DRINK PAST YEAR? IN 1971, 1:EVER, 0:NEVER; 2:MISSING</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>6</td>
<td>alcoholtype</td>
<td>WHICH DO YOU MOST FREQUENTLY DRINK? IN 1971 1: BEER, 2: WINE, 3: LIQUOR, 4: OTHER/UNKNOWN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>allergies</td>
<td>USE ALLERGIES MEDICATION IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>8</td>
<td>asthma</td>
<td>DX ASTHMA IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>9</td>
<td>bithcontrol</td>
<td>BIRTH CONTROL PILLS PAST 6 MONTHS? IN 1971 1:YES, 0:NO, 2:MISSING</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>10</td>
<td>birthplace</td>
<td>CHECK STATE CODE - SECOND PAGE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>11</td>
<td>boweltrouble</td>
<td>USE BOWEL TROUBLE MEDICATION IN 1971, 1:EVER, 0:NEVER, ; 2:MISSING</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>12</td>
<td>bronch</td>
<td>DX CHRONIC BRONCHITIS/EMPHYSEMA IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>13</td>
<td>cholesterol</td>
<td>SERUM CHOLESTEROL (MG/100ML) IN 1971</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>14</td>
<td>chroniccough</td>
<td>DX CHRONIC COUGH IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>15</td>
<td>colitis</td>
<td>DX COLITIS IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>16</td>
<td>dadth</td>
<td>DAY OF DEATH</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>17</td>
<td>dbp</td>
<td>DIASTOLIC BLOOD PRESSURE IN 1982</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>18</td>
<td>death</td>
<td>DEATH BY 1992, 1:YES, 0:NO</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>19</td>
<td>diabetes</td>
<td>DX DIABETES IN 1971, 1:EVER, 0:NEVER, 2:MISSING</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>20</td>
<td>education</td>
<td>AMOUNT OF EDUCATION BY 1971: 1: 8TH GRADE OR LESS, 2: HS DROPOUT, 3: HS, 4:COLLEGE DROPOUT, 5: COLLEGE OR MORE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>cb[<span class="fl">21</span><span class="op">:</span><span class="fl">40</span>,<span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div class="data-frame"><p>20 rows × 3 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">row</th>
<th data-quarto-table-cell-role="th">Variable</th>
<th data-quarto-table-cell-role="th">Description</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="String31">String31</th>
<th data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>21</td>
<td>exercise</td>
<td>IN RECREATION, HOW MUCH EXERCISE? IN 1971, 0:much exercise,1:moderate exercise,2:little or no exercise</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>22</td>
<td>hayfever</td>
<td>DX HAY FEVER IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>23</td>
<td>hbp</td>
<td>DX HIGH BLOOD PRESSURE IN 1971, 1:EVER, 0:NEVER, 2:MISSING</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>24</td>
<td>hbpmed</td>
<td>USE HIGH BLOOD PRESSURE MEDICATION IN 1971, 1:EVER, 0:NEVER, ; 2:MISSING</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>25</td>
<td>headache</td>
<td>USE HEADACHE MEDICATION IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>26</td>
<td>hepatitis</td>
<td>DX HEPATITIS IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>27</td>
<td>hf</td>
<td>DX HEART FAILURE IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>28</td>
<td>hightax82</td>
<td>LIVING IN A HIGHLY TAXED STATE IN 1982, High taxed state of residence=1, 0 otherwise</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>29</td>
<td>ht</td>
<td>HEIGHT IN CENTIMETERS IN 1971</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>30</td>
<td>income</td>
<td>TOTAL FAMILY INCOME IN 1971 11:&lt;$1000, 12: 1000-1999, 13: 2000-2999, 14: 3000-3999, 15: 4000-4999, 16: 5000-5999, 17: 6000-6999, 18: 7000-9999, 19: 10000-14999, 20: 15000-19999, 21: 20000-24999, 22: 25000+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>31</td>
<td>infection</td>
<td>USE INFECTION MEDICATION IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>32</td>
<td>lackpep</td>
<td>USELACK OF PEP MEDICATION IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>33</td>
<td>marital</td>
<td>MARITAL STATUS IN 1971 1: Under 17, 2: Married, 3: Widowed, 4: Never married, 5: Divorced, 6: Separated, 8: Unknown</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>34</td>
<td>modth</td>
<td>MONTH OF DEATH</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>35</td>
<td>nerves</td>
<td>USE NERVES MEDICATION IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>36</td>
<td>nervousbreak</td>
<td>DX NERVOUS BREAKDOWN IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>37</td>
<td>otherpain</td>
<td>USE OTHER PAINS MEDICATION IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>38</td>
<td>pepticulcer</td>
<td>DX PEPTIC ULCER IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>39</td>
<td>pica</td>
<td>DO YOU EAT DIRT OR CLAY, STARCH OR OTHER NON STANDARD FOOD? IN 1971 1:EVER, 0:NEVER; 2:MISSING</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>40</td>
<td>polio</td>
<td>DX POLIO IN 1971, 1:EVER, 0:NEVER</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>cb[<span class="fl">41</span><span class="op">:</span><span class="fl">64</span>,<span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div class="data-frame"><p>24 rows × 3 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">row</th>
<th data-quarto-table-cell-role="th">Variable</th>
<th data-quarto-table-cell-role="th">Description</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th data-quarto-table-cell-role="th" title="String31">String31</th>
<th data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
<td>pregnancies</td>
<td>TOTAL NUMBER OF PREGNANCIES? IN 1971</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>42</td>
<td>price71</td>
<td>AVG TOBACCO PRICE IN STATE OF RESIDENCE 1971 (US$2008)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>43</td>
<td>price71_82</td>
<td>DIFFERENCE IN AVG TOBACCO PRICE IN STATE OF RESIDENCE 1971-1982 (US$2008)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>44</td>
<td>price82</td>
<td>AVG TOBACCO PRICE IN STATE OF RESIDENCE 1982 (US$2008)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>45</td>
<td>qsmk</td>
<td>QUIT SMOKING BETWEEN 1ST QUESTIONNAIRE AND 1982, 1:YES, 0:NO</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>46</td>
<td>race</td>
<td>0: WHITE 1: BLACK OR OTHER IN 1971</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>47</td>
<td>sbp</td>
<td>SYSTOLIC BLOOD PRESSURE IN 1982</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>48</td>
<td>school</td>
<td>HIGHEST GRADE OF REGULAR SCHOOL EVER IN 1971</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>49</td>
<td>seqn</td>
<td>UNIQUE PERSONAL IDENTIFIER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>50</td>
<td>sex</td>
<td>0: MALE 1: FEMALE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>51</td>
<td>smokeintensity</td>
<td>NUMBER OF CIGARETTES SMOKED PER DAY IN 1971</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>52</td>
<td>smkintensity 82_71</td>
<td>INCREASE IN NUMBER OF CIGARETTES/DAY BETWEEN 1971 and 1982</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>53</td>
<td>smokeyrs</td>
<td>YEARS OF SMOKING</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>54</td>
<td>tax71</td>
<td>TOBACCO TAX IN STATE OF RESIDENCE 1971 (US$2008)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>55</td>
<td>tax71_82</td>
<td>DIFFERENCE IN TOBACCO TAX IN STATE OF RESIDENCE 1971-1982 (US$2008)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>56</td>
<td>tax82</td>
<td>TOBACCO TAX IN STATE OF RESIDENCE 1971 (US$2008)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>57</td>
<td>tb</td>
<td>DX TUBERCULOSIS IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>58</td>
<td>tumor</td>
<td>DX MALIGNANT TUMOR/GROWTH IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>59</td>
<td>weakheart</td>
<td>USE WEAK HEART MEDICATION IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>60</td>
<td>wt71</td>
<td>WEIGHT IN KILOGRAMS IN 1971</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>61</td>
<td>wt82</td>
<td>WEIGHT IN KILOGRAMS IN 1982</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>62</td>
<td>wt82_71</td>
<td>WEIGHT CHANGE IN KILOGRAMS</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>63</td>
<td>wtloss</td>
<td>USE WEIGHT LOSS MEDICATION IN 1971, 1:EVER, 0:NEVER</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>64</td>
<td>yrdth</td>
<td>YEAR OF DEATH</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="updates-from-book-author" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="updates-from-book-author"><span class="header-section-number">4</span> Updates from book author</h2>
<ol type="1">
<li>What is new in DataFrames.jl 1.5. Mar 24, 2023. Available from: <a href="https://bkamins.github.io/julialang/2023/03/24/df15.html">https://bkamins.github.io/julialang/2023/03/24/df15.html</a></li>
<li>Hunting for bugs in Julia for Data Analysis. Medium. March 3, 2023. Available from: <a href="https://medium.com/bkamins/hunting-for-bugs-in-julia-for-data-analysis-ed6f4d1ce6bd">https://medium.com/bkamins/hunting-for-bugs-in-julia-for-data-analysis-ed6f4d1ce6bd</a></li>
<li>Errata and source code for book is available from <a href="https://github.com/bkamins/JuliaForDataAnalysis">https://github.com/bkamins/JuliaForDataAnalysis</a></li>
</ol>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-Kaminski2023-isbn978-1633439368" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Kaminski B. Julia for data analysis. New York, NY: Manning Publications; 2023. </div>
</div>
<div id="ref-Aragon2003_pmid12515584" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Aragón TJ, Novotny S, Enanoria W, Vugia DJ, Khalakdina A, Katz MH. Endemic cryptosporidiosis and exposure to municipal tap water in persons with acquired immunodeficiency syndrome (<span>AIDS</span>): A case-control study. <span>BMC</span> Public Health [Internet]. 2003 Jan;3(1). Available from: <a href="https://doi.org/10.1186/1471-2458-3-2">https://doi.org/10.1186/1471-2458-3-2</a></div>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Used Rstudio on 2021 MacBook Pro M1 Max with 32 GB RAM under Ventura 13.2.1<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>“The reason for the difference is that Julia uses 64-bit integers and R uses 64-bit floats by default to do these computations.” Source: https://twitter.com/BogumilKaminski/status/1629968902456311818<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Notice that in Julia I can use <code>1000000000</code> or <code>1_000_000_000</code> for the number 1 billion.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>In the Pluto.jl package, vectors are displayed horizontally.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>To learn more visit <a href="https://freecontent.manning.com/using-multiple-dispatch-in-julia/">https://freecontent.manning.com/using-multiple-dispatch-in-julia/</a>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>https://stackoverflow.com/questions/27086159/what-is-the-difference-between-using-and-import-in-julia-when-building-a-mod<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Created with <a href="https://quarto.org">Quarto.org</a>—an open-source scientific and technical publishing system built on <a href="https://pandoc.org/">Pandoc</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>