<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tomás Aragón">
<meta name="dcterms.date" content="2023-03-31">
<meta name="description" content="“Calculating multi-attribute criteria weights with Julia”">

<title>Dr.&nbsp;Tomás Aragón - Simple method to get criteria weights for decision making</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-111617948-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Dr.&nbsp;Tomás Aragón - Simple method to get criteria weights for decision making">
<meta name="twitter:description" content="“Calculating multi-attribute criteria weights with Julia”">
<meta name="twitter:image" content="https://drtomasaragon.github.io/posts/2023-03-31-criteria-weights-for-decisions/images/book_cover_julia_for_data_analysis_1400x865.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Dr.&nbsp;Tomás Aragón</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../works.html" rel="" target="">
 <span class="menu-text">Works</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../subscription.html" rel="" target="">
 <span class="menu-text">Subscribe</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://threads.net/drtomasaragon" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/drtomasaragon" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/drtomasaragon" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Simple method to get criteria weights for decision making</h1>
                  <div>
        <div class="description">
          <p>“Calculating multi-attribute criteria weights with Julia”</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Julia</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Data science</div>
                <div class="quarto-category">Programming</div>
                <div class="quarto-category">Decision intelligence</div>
                <div class="quarto-category">Scientific computing</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://taragonmd.github.io">Tomás Aragón</a> <a href="https://orcid.org/0000-0002-2058-0423" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              California Department of Public Health
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 31, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#making-single-and-multi-attribute-decisions" id="toc-making-single-and-multi-attribute-decisions" class="nav-link" data-scroll-target="#making-single-and-multi-attribute-decisions"><span class="header-section-number">2</span> Making single and multi-attribute decisions</a>
  <ul class="collapse">
  <li><a href="#single-attribute-decision" id="toc-single-attribute-decision" class="nav-link" data-scroll-target="#single-attribute-decision"><span class="header-section-number">2.1</span> Single-attribute decision</a></li>
  <li><a href="#multi-attribute-decision" id="toc-multi-attribute-decision" class="nav-link" data-scroll-target="#multi-attribute-decision"><span class="header-section-number">2.2</span> Multi-attribute decision</a></li>
  </ul></li>
  <li><a href="#calculating-criteria-weightsthe-easy-way" id="toc-calculating-criteria-weightsthe-easy-way" class="nav-link" data-scroll-target="#calculating-criteria-weightsthe-easy-way"><span class="header-section-number">3</span> Calculating criteria weights—the easy way</a>
  <ul class="collapse">
  <li><a href="#ratio-ordinal-method-in-julia" id="toc-ratio-ordinal-method-in-julia" class="nav-link" data-scroll-target="#ratio-ordinal-method-in-julia"><span class="header-section-number">3.1</span> Ratio ordinal method in Julia</a></li>
  <li><a href="#step-2-evaluators-rank-the-criteria" id="toc-step-2-evaluators-rank-the-criteria" class="nav-link" data-scroll-target="#step-2-evaluators-rank-the-criteria"><span class="header-section-number">3.2</span> Step 2: Evaluators rank the criteria</a></li>
  <li><a href="#step-3-calculate-mean-criteria-weights" id="toc-step-3-calculate-mean-criteria-weights" class="nav-link" data-scroll-target="#step-3-calculate-mean-criteria-weights"><span class="header-section-number">3.3</span> Step 3: Calculate mean criteria weights</a></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix"><span class="header-section-number">4</span> Appendix</a>
  <ul class="collapse">
  <li><a href="#function-to-automate-calculating-mean-weights" id="toc-function-to-automate-calculating-mean-weights" class="nav-link" data-scroll-target="#function-to-automate-calculating-mean-weights"><span class="header-section-number">4.1</span> Function to automate calculating mean weights</a></li>
  <li><a href="#review-of-selected-julia-code" id="toc-review-of-selected-julia-code" class="nav-link" data-scroll-target="#review-of-selected-julia-code"><span class="header-section-number">4.2</span> Review of selected Julia code</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>At the California Department of Public Health, we promote <a href="../2021-03-13-decision-intelligence01/index.html">decision intelligence</a> (DI)—improving how we make team decisions to find, select, and solve problems and to improve outcomes. A foundational component of DI is decision quality—the six requirements of good decision making. At a minimum, a decision quality checklist (DQ) (<a href="#tbl-dqr1">Table&nbsp;1</a>) improves the quality of decisions at any stage of problem solving. A good decision is only as strong as its weakest link. (To learn more about DQ watch 3.5min video from the <a href="https://www.decisioneducation.org/">Decision Education Foundation</a>.)</p>
<div id="tbl-dqr1" class="anchored">
<table class="table">
<caption>Table&nbsp;1: Key questions to answer for decision quality (DQ)</caption>
<colgroup>
<col style="width: 4%">
<col style="width: 11%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th>No.</th>
<th>Requirement</th>
<th>Key question to ask</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Frame</td>
<td>Are we clear on the problem we are solving?</td>
</tr>
<tr class="even">
<td>2</td>
<td>Values</td>
<td>Have we identified what we truly want?</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Alternatives</td>
<td>Do we have a good set of alternatives?</td>
</tr>
<tr class="even">
<td>4</td>
<td>Information</td>
<td>Have we gathered the relevant information?</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Reasoning</td>
<td>How will we evaluate alternatives to find the one that gets us the most of what what we truly want?</td>
</tr>
<tr class="even">
<td>6</td>
<td>Commitment</td>
<td>Are we committed to follow through on our choice.</td>
</tr>
</tbody>
</table>
</div>
<p>Making higher quality decisions as a group can be challenging. Our brains prefer intuitive decision making. Deliberations are cognitively exhausting, especially in the face of competing objectives, uncertainty, and time constraints. That is why, unfortunately, decision-making is often deferred to an authority figure. It’s better to embrace team decision making but practice with simple tools and methods that promote group engagement, deliberation, and decision quality.</p>
</section>
<section id="making-single-and-multi-attribute-decisions" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="making-single-and-multi-attribute-decisions"><span class="header-section-number">2</span> Making single and multi-attribute decisions</h2>
<section id="single-attribute-decision" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="single-attribute-decision"><span class="header-section-number">2.1</span> Single-attribute decision</h3>
<p>Suppose our team needs to select from several alternatives and it will be based on a <strong>single attribute</strong>; for example, choosing one of five available colors to paint our office. That attribute—color—becomes our single criterion and we apply the ranking method illustrated below. In this example the single attribute (color) represents the alternatives (five colors to choose from).</p>
</section>
<section id="multi-attribute-decision" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="multi-attribute-decision"><span class="header-section-number">2.2</span> Multi-attribute decision</h3>
<p>However, more commonly, based on our <strong>frame</strong> (values, objectives, and key results), our team needs to select from among several <strong>alternatives</strong>, each of which has <strong>mutliple attributes</strong>. Selection examples include buying a smartphone, hiring an employee, or selecting a vendor. As individuals and as a group, we have preferences for these attributes based on what we know (<strong>information</strong>) and what consequences and impacts we care about (<strong>prospects</strong>). We need sound <strong>reasoning</strong> but it will not require a complex decision analysis. Engaging the team in fair and transparent deliberative decision making builds trust, consensus, and <strong>commitment</strong>.</p>
<p>Our main task is to (a) <strong>develop criteria</strong> based on these attributes, (b) <strong>weight the criteria</strong> based on importance to us (preference), and (c) <strong>rate the alternatives</strong> based on the criteria and evidence (data, community, experts, analysis). Ideally, the criteria should be weighted without any knowledge of the alternatives. This is to prevent evaluators from biasing the criteria weights in favor of their favorite alternative.</p>
<p>In this blog posting I show how to weight criteria using a simple ranking method. In a future blog post, I will show how to apply weighted criteria to rank and select alternatives. This first step, weighting criteria, is very powerful and practical. We will use a trivial example to nail down the concepts.</p>
<p>Now, suppose we wish to buy a car and our choices are a Honda Civic, and Subaru Impreza, or Toyota Corolla. We have data on the following attributes: safety (S), mileage (M), reliability (R), color (C), price (P), and resale value (V). <a href="#tbl-car">Table&nbsp;2</a> summarizes the DQ requirements for buying our car.</p>
<div id="tbl-car" class="anchored">
<table class="table">
<caption>Table&nbsp;2: Decision quality requirements for buying a car</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 56%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>No.</th>
<th>Requirement</th>
<th>Key question to ask</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Frame</td>
<td>Are we clear on the problem we are solving?</td>
<td>Need personal transportion.</td>
</tr>
<tr class="even">
<td>2</td>
<td>Values</td>
<td>Have we identified what we truly want?</td>
<td>Car within my budget.</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Alternatives</td>
<td>Do we have a good set of alternatives?</td>
<td>Civic, Corolla, or Impreza</td>
</tr>
<tr class="even">
<td>4</td>
<td>Information</td>
<td>Have we gathered the relevant information?</td>
<td>Color, mileage, price, reliability, safety, resale value</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Reasoning</td>
<td>How will we evaluate alternatives to find the one that gets us the most of what what we truly want?</td>
<td>Ranking algorithm using weight calculations</td>
</tr>
<tr class="even">
<td>6</td>
<td>Commitment</td>
<td>Are we committed to follow through on our choice.</td>
<td>Yes, my spouse approves.</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="calculating-criteria-weightsthe-easy-way" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="calculating-criteria-weightsthe-easy-way"><span class="header-section-number">3</span> Calculating criteria weights—the easy way</h2>
<p>Group deliberative decision-making is cognitively exhausting. So, anything you can do to make the process easier will keep team members engaged. Do not let “perfection become the enemy of the good”. The easiest way to generate criteria weights from a team of evaluators is to use a rank ordinal method <span class="citation" data-cites="Danielson2017_doi10.1007/978-3-319-52624-9_2">[<a href="#ref-Danielson2017_doi10.1007/978-3-319-52624-9_2" role="doc-biblioref">1</a>]</span>.</p>
<p>Give evaluators small pieces of paper with one criterion printed on on each. If we have five criteria, they get five small pieces of paper. Have them rank them from top to bottom. Once they have ranked them, tape their ranking onto an 8.5in x 11in paper and hand to the facilitator. This ranking is entered into the computer for analysis (see below).</p>
<section id="ratio-ordinal-method-in-julia" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="ratio-ordinal-method-in-julia"><span class="header-section-number">3.1</span> Ratio ordinal method in Julia</h3>
<p>I will demonstrate this method using the Julia language. This method can also be implemented using R, Python, or Microsoft Excel.</p>
<p>For rating the cars we have six criteria (attributes) for which we need to calculate weights:</p>
<ol type="1">
<li>Color (C)</li>
<li>Mileage (M)</li>
<li>Price (P)</li>
<li>Reliability (R)</li>
<li>Safety (S)</li>
<li>Value, resale (V)</li>
</ol>
<p>We have five evaluators that will rank the criteria based on their knowledge, experience, expertise, and wisdom. It is much better for them to rank the criteria independently and without thinking about specific cars, otherwise they may game (bias) the weighting.</p>
<p>Here are the steps:</p>
<ol type="1">
<li>Select a ranking method to calculate weights for a specific number of criteria, in this case we have six criteria. We will write and use a Julia function that implements the SR method from <span class="citation" data-cites="Danielson2017_doi10.1007/978-3-319-52624-9_2">[<a href="#ref-Danielson2017_doi10.1007/978-3-319-52624-9_2" role="doc-biblioref">1</a>]</span>.</li>
<li>Have each evaluator independently rank the criteria.</li>
<li>Use Julia to calculate the final criteria weights. We will use the <em>split-apply-combine</em> workflow that I introduced in a previous <a href="../2023-02-20-julia-for-data-analysis/index.html">blog post</a> and book review <span class="citation" data-cites="Kaminski2023-isbn978-1633439368">[<a href="#ref-Kaminski2023-isbn978-1633439368" role="doc-biblioref">2</a>]</span>.</li>
</ol>
<section id="step-1-the-sr-method-for-generating-criteria-weights" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="step-1-the-sr-method-for-generating-criteria-weights"><span class="header-section-number">3.1.1</span> Step 1: The SR method for generating criteria weights</h4>
<p>Here is the formula where <span class="math inline">\(N\)</span> is the number of criteria, and <span class="math inline">\(w_i^{SR}\)</span> is the weight for the <span class="math inline">\(i^{th}\)</span> criterion <span class="citation" data-cites="Danielson2017_doi10.1007/978-3-319-52624-9_2">[<a href="#ref-Danielson2017_doi10.1007/978-3-319-52624-9_2" role="doc-biblioref">1</a>]</span>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p><span class="math display">\[
w_i^{SR} = \frac{1/i + \frac{N+1-i}{N}}{\sum_{j=1}^N (1/i + \frac{N+1-i}{N})}
\]</span></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsBase</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">calculate_rank_weights</span>(n<span class="op">::</span><span class="dt">Int64</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> <span class="fu">zeros</span>(n)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        num[i] <span class="op">=</span> (<span class="fl">1</span><span class="op">/</span>i) <span class="op">+</span> ( (n <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> i) <span class="op">/</span> n )</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    wi <span class="op">=</span> num <span class="op">/</span> <span class="fu">sum</span>(num)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wi</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>wi <span class="op">=</span> <span class="fu">calculate_rank_weights</span>(<span class="fl">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>6-element Vector{Float64}:
 0.3361344537815126
 0.22408963585434175
 0.1680672268907563
 0.12605042016806722
 0.0896358543417367
 0.05602240896358543</code></pre>
</div>
</div>
<p>The weights sum to 1, as expected.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(wi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>1.0</code></pre>
</div>
</div>
</section>
</section>
<section id="step-2-evaluators-rank-the-criteria" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="step-2-evaluators-rank-the-criteria"><span class="header-section-number">3.2</span> Step 2: Evaluators rank the criteria</h3>
<p>Five evaluators rank the criteria based on their expertise.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>eval1 <span class="op">=</span> [<span class="st">"Mileage"</span>, <span class="st">"Color"</span>, <span class="st">"Price"</span>, <span class="st">"Safety"</span>, <span class="st">"Reliability"</span>, <span class="st">"Value"</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>eval2 <span class="op">=</span> [<span class="st">"Mileage"</span>, <span class="st">"Color"</span>, <span class="st">"Safety"</span>, <span class="st">"Reliability"</span>, <span class="st">"Value"</span>, <span class="st">"Price"</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>eval3 <span class="op">=</span> [<span class="st">"Color"</span>, <span class="st">"Value"</span>, <span class="st">"Price"</span>, <span class="st">"Mileage"</span>, <span class="st">"Reliability"</span>, <span class="st">"Safety"</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>eval4 <span class="op">=</span> [<span class="st">"Mileage"</span>, <span class="st">"Value"</span>, <span class="st">"Color"</span>, <span class="st">"Safety"</span>, <span class="st">"Reliability"</span>, <span class="st">"Price"</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>eval5 <span class="op">=</span> [<span class="st">"Safety"</span>, <span class="st">"Price"</span>, <span class="st">"Color"</span>, <span class="st">"Reliability"</span>, <span class="st">"Mileage"</span>, <span class="st">"Value"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>6-element Vector{String}:
 "Safety"
 "Price"
 "Color"
 "Reliability"
 "Mileage"
 "Value"</code></pre>
</div>
</div>
<p>Next, we organize the evaluator criteria rankings and the SR method criteria weights into a data frame with three columns:</p>
<ul>
<li>evaluators (optional)</li>
<li>evaluator_rankings (required)</li>
<li>weights (required)</li>
</ul>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ne <span class="op">=</span> <span class="fl">5</span>; <span class="co"># number of evaluators</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>nc <span class="op">=</span> <span class="fl">6</span>; <span class="co"># number for criteria</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>evaluators <span class="op">=</span> <span class="fu">repeat</span>([<span class="st">"eval"</span> <span class="op">.*</span> <span class="fu">string</span>.(<span class="fl">1</span><span class="op">:</span>ne)<span class="op">...</span>], inner<span class="op">=</span><span class="fu">repeat</span>([nc]))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>evaluator_rankings <span class="op">=</span> <span class="fu">vcat</span>( eval1, eval2, eval3, eval4, eval5 )</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> <span class="fu">repeat</span>( wi, ne )</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hcat</span>(evaluators, evaluator_rankings, weights), </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"evaluator"</span>, <span class="st">"criteria"</span>, <span class="st">"weight"</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div class="data-frame"><p>30 rows × 3 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">evaluator</th>
<th data-quarto-table-cell-role="th">criteria</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>eval1</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>eval1</td>
<td>Color</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>eval1</td>
<td>Price</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>eval1</td>
<td>Safety</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>eval1</td>
<td>Reliability</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>eval1</td>
<td>Value</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>eval2</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>eval2</td>
<td>Color</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>eval2</td>
<td>Safety</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>eval2</td>
<td>Reliability</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>eval2</td>
<td>Value</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>eval2</td>
<td>Price</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>eval3</td>
<td>Color</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>eval3</td>
<td>Value</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>eval3</td>
<td>Price</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>eval3</td>
<td>Mileage</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>eval3</td>
<td>Reliability</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>eval3</td>
<td>Safety</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>eval4</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>eval4</td>
<td>Value</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>eval4</td>
<td>Color</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>eval4</td>
<td>Safety</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>eval4</td>
<td>Reliability</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>eval4</td>
<td>Price</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>eval5</td>
<td>Safety</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>eval5</td>
<td>Price</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>eval5</td>
<td>Color</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>eval5</td>
<td>Reliability</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29</td>
<td>eval5</td>
<td>Mileage</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>eval5</td>
<td>Value</td>
<td>0.0560224</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="step-3-calculate-mean-criteria-weights" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="step-3-calculate-mean-criteria-weights"><span class="header-section-number">3.3</span> Step 3: Calculate mean criteria weights</h3>
<p>Calculate mean criteria weights using split-apply-combine workflow. In other words, stratifying by criterion, what is the mean weight for each criterion (attribute)?</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## split</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> <span class="fu">groupby</span>(df, <span class="op">:</span>criteria)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<p><b>GroupedDataFrame with 6 groups based on key: criteria</b></p><p><i>First Group (5 rows): criteria = "Mileage"</i></p><div class="data-frame">
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">evaluator</th>
<th data-quarto-table-cell-role="th">criteria</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>eval1</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>eval2</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>eval3</td>
<td>Mileage</td>
<td>0.12605</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>eval4</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>eval5</td>
<td>Mileage</td>
<td>0.0896359</td>
</tr>
</tbody>
</table>
<p>⋮</p>
<p><em>Last Group (5 rows): criteria = "Value"</em></p>
<div class="data-frame">
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">evaluator</th>
<th data-quarto-table-cell-role="th">criteria</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>eval1</td>
<td>Value</td>
<td>0.0560224</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>eval2</td>
<td>Value</td>
<td>0.0896359</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>eval3</td>
<td>Value</td>
<td>0.22409</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>eval4</td>
<td>Value</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>eval5</td>
<td>Value</td>
<td>0.0560224</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">## combine and apply </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>crit_weights <span class="op">=</span> <span class="fu">combine</span>(gdf, <span class="op">:</span>weight <span class="op">=&gt;</span> mean)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sort!</span>(crit_weights, <span class="op">:</span>weight_mean, rev <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div class="data-frame"><p>6 rows × 2 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">criteria</th>
<th data-quarto-table-cell-role="th">weight_mean</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Mileage</td>
<td>0.244818</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Color</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Safety</td>
<td>0.162465</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Price</td>
<td>0.134454</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Value</td>
<td>0.129972</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>Reliability</td>
<td>0.104202</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>These are the final criteria weights and, as expected, they sum to 1.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(crit_weights.weight_mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>1.0</code></pre>
</div>
</div>
<p>In this example, mileage (M) has the highest weight (24.5%) and reliability (R) has the lowest weight (10.4%).</p>
<p>In a future blog, I will show how to score the alternatives (Honda Civic, Toyota Corolla, and Subaru Impreza) with these weighted criteria, and then making a final ranking of which car to select.</p>
</section>
</section>
<section id="appendix" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="appendix"><span class="header-section-number">4</span> Appendix</h2>
<section id="function-to-automate-calculating-mean-weights" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="function-to-automate-calculating-mean-weights"><span class="header-section-number">4.1</span> Function to automate calculating mean weights</h3>
<p>We created the <code>calculate_rank_weights</code> function to calculate the weights for <span class="math inline">\(n\)</span> criteria using the SR method. Then we used Julia to calculate the mean weights for five evaluators.</p>
<p>Now we create a final function to automate calculating the mean weights. This function will handle an arbitrary number of vectors with rankings, or a matrix created from those vectors beforehand. Notice that this new function will call our previous <code>calculate_rank_weights</code> function.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">calculate_mean_weights</span>(x<span class="op">...</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">hcat</span>(x<span class="op">...</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    ncrit, neval <span class="op">=</span> <span class="fu">size</span>(x, <span class="fl">1</span>), <span class="fu">size</span>(x, <span class="fl">2</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    wts_i <span class="op">=</span> <span class="fu">calculate_rank_weights</span>(ncrit)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> <span class="fu">repeat</span>( wts_i, neval )</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    evaluators <span class="op">=</span> <span class="fu">repeat</span>( </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"eval"</span> <span class="op">.*</span> <span class="fu">string</span>.(<span class="fl">1</span><span class="op">:</span>neval)<span class="op">...</span>], </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        inner <span class="op">=</span> <span class="fu">repeat</span>([ncrit])</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    evalvator_rankings <span class="op">=</span> <span class="fu">reshape</span>(x, ncrit <span class="op">*</span> neval)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> <span class="fu">DataFrame</span>( </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">hcat</span>(evaluators, evaluator_rankings, weights), </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"evaluator"</span>, <span class="st">"criteria"</span>, <span class="st">"weight"</span>] </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    gdf <span class="op">=</span> <span class="fu">groupby</span>(df, <span class="op">:</span>criteria)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    mean_wts <span class="op">=</span> <span class="fu">sort!</span>(</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">combine</span>(gdf, <span class="op">:</span>weight <span class="op">=&gt;</span> mean), </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>weight_mean, rev <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    )   </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> mean_wts,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> df</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>calculate_mean_weights (generic function with 1 method)</code></pre>
</div>
</div>
<p>Here we test passing vectors as arguments to the <code>calculate_mean_weights</code> function.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>r1 <span class="op">=</span> <span class="fu">calculate_mean_weights</span>(eval1, eval2, eval3, eval4, eval5);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results are saved in <code>r1</code> and the semi-colon (<code>;</code>) suppresses the output. We use <code>typeof</code> function to evaluate the type of <code>r1</code>.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(r1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>NamedTuple{(:weights, :data), Tuple{DataFrame, DataFrame}}</code></pre>
</div>
</div>
<p>We see that <code>r1</code> is a NamedTuple and it contains two data frames named <code>weights</code> and <code>data</code>. We can index each separately.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>r1.weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div class="data-frame"><p>6 rows × 2 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">criteria</th>
<th data-quarto-table-cell-role="th">weight_mean</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Mileage</td>
<td>0.244818</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Color</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Safety</td>
<td>0.162465</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Price</td>
<td>0.134454</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Value</td>
<td>0.129972</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>Reliability</td>
<td>0.104202</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>r1.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div class="data-frame"><p>30 rows × 3 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">evaluator</th>
<th data-quarto-table-cell-role="th">criteria</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>eval1</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>eval1</td>
<td>Color</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>eval1</td>
<td>Price</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>eval1</td>
<td>Safety</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>eval1</td>
<td>Reliability</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>eval1</td>
<td>Value</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>eval2</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>eval2</td>
<td>Color</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>eval2</td>
<td>Safety</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>eval2</td>
<td>Reliability</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>eval2</td>
<td>Value</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>eval2</td>
<td>Price</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>eval3</td>
<td>Color</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>eval3</td>
<td>Value</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>eval3</td>
<td>Price</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>eval3</td>
<td>Mileage</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>eval3</td>
<td>Reliability</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>eval3</td>
<td>Safety</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>eval4</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>eval4</td>
<td>Value</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>eval4</td>
<td>Color</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>eval4</td>
<td>Safety</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>eval4</td>
<td>Reliability</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>eval4</td>
<td>Price</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>eval5</td>
<td>Safety</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>eval5</td>
<td>Price</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>eval5</td>
<td>Color</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>eval5</td>
<td>Reliability</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29</td>
<td>eval5</td>
<td>Mileage</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>eval5</td>
<td>Value</td>
<td>0.0560224</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Next, we create the matrix of evaluator data and then pass it to the <code>calculate_mean_weights</code> function.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>eval_rankings_tab <span class="op">=</span> <span class="fu">hcat</span>(eval1, eval2, eval3, eval4, eval5)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> <span class="fu">calculate_mean_weights</span>(eval_rankings_tab);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results are saved in <code>r</code> and the semi-colon (<code>;</code>) suppresses the output. We use <code>typeof</code> function to evaluate the type of <code>r2</code>.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>NamedTuple{(:weights, :data), Tuple{DataFrame, DataFrame}}</code></pre>
</div>
</div>
<p>We see that <code>r2</code> is a NamedTuple and it contains two data frames named <code>weights</code> and <code>data</code>. We can index each separately.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>r2.weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div class="data-frame"><p>6 rows × 2 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">criteria</th>
<th data-quarto-table-cell-role="th">weight_mean</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Mileage</td>
<td>0.244818</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Color</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Safety</td>
<td>0.162465</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Price</td>
<td>0.134454</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Value</td>
<td>0.129972</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>Reliability</td>
<td>0.104202</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>r2.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div class="data-frame"><p>30 rows × 3 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">evaluator</th>
<th data-quarto-table-cell-role="th">criteria</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>eval1</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>eval1</td>
<td>Color</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>eval1</td>
<td>Price</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>eval1</td>
<td>Safety</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>eval1</td>
<td>Reliability</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>eval1</td>
<td>Value</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>eval2</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>eval2</td>
<td>Color</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>eval2</td>
<td>Safety</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>eval2</td>
<td>Reliability</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>eval2</td>
<td>Value</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>eval2</td>
<td>Price</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>eval3</td>
<td>Color</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>eval3</td>
<td>Value</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>eval3</td>
<td>Price</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>eval3</td>
<td>Mileage</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>eval3</td>
<td>Reliability</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>eval3</td>
<td>Safety</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>eval4</td>
<td>Mileage</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>eval4</td>
<td>Value</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>eval4</td>
<td>Color</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>eval4</td>
<td>Safety</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>eval4</td>
<td>Reliability</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>eval4</td>
<td>Price</td>
<td>0.0560224</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>eval5</td>
<td>Safety</td>
<td>0.336134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>eval5</td>
<td>Price</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>eval5</td>
<td>Color</td>
<td>0.168067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>eval5</td>
<td>Reliability</td>
<td>0.12605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29</td>
<td>eval5</td>
<td>Mileage</td>
<td>0.0896359</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>eval5</td>
<td>Value</td>
<td>0.0560224</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>calculate_mean_weights</code> function worked for both vectors or a matrix. This was possible because of the splat operator (<code>...</code>) as in the two lines below.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">calculate_mean_weights</span>(x<span class="op">...</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">hcat</span>(x<span class="op">...</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="review-of-selected-julia-code" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="review-of-selected-julia-code"><span class="header-section-number">4.2</span> Review of selected Julia code</h3>
<p>Did you know you can use tuples to bind variable names to values?</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> <span class="fl">33</span>, <span class="fl">99</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(33, 99)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>33</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>99</code></pre>
</div>
</div>
<p>This is super handy when we want to swap values between variables in one step.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> y, x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>(99, 33)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>99</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>33</code></pre>
</div>
</div>
<p>Here is how to prefill arrays:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zeros</span>(<span class="fl">2</span>, <span class="fl">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>2×3 Matrix{Float64}:
 0.0  0.0  0.0
 0.0  0.0  0.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ones</span>(<span class="fl">2</span>, <span class="fl">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>2×3 Matrix{Float64}:
 1.0  1.0  1.0
 1.0  1.0  1.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fill</span>(<span class="fl">1</span>, (<span class="fl">2</span>, <span class="fl">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>2×3 Matrix{Int64}:
 1  1  1
 1  1  1</code></pre>
</div>
</div>
<p>The <code>reshape</code> function reshapes an array.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="fu">Vector</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>16-element Vector{Int64}:
  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reshape</span>(A, (<span class="fl">4</span>, <span class="fl">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>4×4 Matrix{Int64}:
 1  5   9  13
 2  6  10  14
 3  7  11  15
 4  8  12  16</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reshape</span>(A, <span class="fl">2</span>, <span class="op">:</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>2×8 Matrix{Int64}:
 1  3  5  7   9  11  13  15
 2  4  6  8  10  12  14  16</code></pre>
</div>
</div>
<p>Her is vertical concatenation (<code>vcat</code>): (<code>hcat</code>):</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>]</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vcat</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>6-element Vector{Int64}:
 1
 2
 4
 4
 5
 6</code></pre>
</div>
</div>
<p>Here is horizontal concatenation (<code>hcat</code>):</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>3×2 Matrix{Int64}:
 1  4
 2  5
 4  6</code></pre>
</div>
</div>
<p>The <code>!</code> operator signifies mutating (permanently changing) an object:</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">## combine and apply </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>crit_weights <span class="op">=</span> <span class="fu">combine</span>(gdf, <span class="op">:</span>weight <span class="op">=&gt;</span> mean)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sort!</span>(crit_weights, <span class="op">:</span>weight_mean, rev <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div class="data-frame"><p>6 rows × 2 columns</p>
<table class="data-frame table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">criteria</th>
<th data-quarto-table-cell-role="th">weight_mean</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" title="Any">Any</th>
<th data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Mileage</td>
<td>0.244818</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Color</td>
<td>0.22409</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Safety</td>
<td>0.162465</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Price</td>
<td>0.134454</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Value</td>
<td>0.129972</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>Reliability</td>
<td>0.104202</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>repeat</code> function repeat a pattern.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">repeat</span>([<span class="fl">2</span>, <span class="fl">5</span>], <span class="fl">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>6-element Vector{Int64}:
 2
 5
 2
 5
 2
 5</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">## equivalent to above</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">repeat</span>([<span class="fl">2</span>, <span class="fl">5</span>], outer<span class="op">=</span><span class="fu">repeat</span>([<span class="fl">3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>6-element Vector{Int64}:
 2
 5
 2
 5
 2
 5</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">repeat</span>([<span class="fl">2</span>, <span class="fl">5</span>], inner<span class="op">=</span><span class="fu">repeat</span>([<span class="fl">3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>6-element Vector{Int64}:
 2
 2
 2
 5
 5
 5</code></pre>
</div>
</div>
<p>Generating array of strings. Note how the splat (<code>...</code>) operator works.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">"eval"</span> <span class="op">.*</span> <span class="fu">string</span>.(<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>1-element Vector{Vector{String}}:
 ["eval1", "eval2", "eval3"]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">"eval"</span> <span class="op">.*</span> <span class="fu">string</span>.(<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>)<span class="op">...</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>3-element Vector{String}:
 "eval1"
 "eval2"
 "eval3"</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">repeat</span>([<span class="st">"eval"</span> <span class="op">.*</span> <span class="fu">string</span>.(<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>)], inner<span class="op">=</span><span class="fu">repeat</span>([<span class="fl">2</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>2-element Vector{Vector{String}}:
 ["eval1", "eval2", "eval3"]
 ["eval1", "eval2", "eval3"]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">repeat</span>([<span class="st">"eval"</span> <span class="op">.*</span> <span class="fu">string</span>.(<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>)<span class="op">...</span>], inner<span class="op">=</span><span class="fu">repeat</span>([<span class="fl">2</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>6-element Vector{String}:
 "eval1"
 "eval1"
 "eval2"
 "eval2"
 "eval3"
 "eval3"</code></pre>
</div>
</div>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-Danielson2017_doi10.1007/978-3-319-52624-9_2" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Danielson M, Ekenberg L. Trade-offs for ordinal ranking methods in multi-criteria decisions. In: Bajwa D, Koeszegi ST, Vetschera R, editors. Group decision and negotiation Theory, empirical evidence, and application [Internet]. Cham: Springer International Publishing; 2017. p. 16–27. Available from: <a href="https://doi.org/10.1007/978-3-319-52624-9_2">https://doi.org/10.1007/978-3-319-52624-9_2</a></div>
</div>
<div id="ref-Kaminski2023-isbn978-1633439368" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Kaminski B. Julia for data analysis. New York, NY: Manning Publications; 2023. </div>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The SR method was selected because it was the best performing.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Created with <a href="https://quarto.org">Quarto.org</a>—an open-source scientific and technical publishing system built on <a href="https://pandoc.org/">Pandoc</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>